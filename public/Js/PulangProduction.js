const URL=document.getElementById("url").value,TOKEN=document.getElementById("token").value;function displayU(){const t=document.getElementsByClassName("update");for(let n=0;n<t.length;n++)t[n].addEventListener("click",(function(){const t=this.getAttribute("data-id");console.log(t),document.getElementById("form-update").setAttribute("action",URL+"/pulang/"+t),fetch(URL+"/pulang/view/get/"+t).then((t=>t.json())).then((t=>{document.querySelector("input[name=no_truk]").value=t.data.no_truk,document.querySelector("input[name=berat_pulang]").value=t.data.berat_pulang,document.querySelector("input[name=refaksi]").value=t.data.refaksi,document.querySelector("input[name=tanggal_pulang]").value=t.data.tanggal_pulang,document.querySelector("input[name=tanggal_bongkar]").value=t.data.tanggal_bongkar,document.querySelector("input[name=berat_bersih]").value=t.data.berat_pulang-t.data.refaksi}))}))}function filter(){try{getfilter()}catch(t){console.log(t),document.getElementById("list-data").innerHTML="error"}}function getfilter(){const t=document.getElementById("date-range").value.split(" / "),n=t[0].split("-"),a=t[1].split("-"),e=`${n[2]}-${n[1]}-${n[0]}`,d=`${a[2]}-${a[1]}-${a[0]}`;fetch(`${URL}/filterpulang`,{method:"post",body:JSON.stringify({tgl1:e,tgl2:d}),headers:{"Content-Type":"application/json","X-CSRF-Token":TOKEN}}).then((t=>t.json())).then((t=>{document.getElementById("list-data").innerHTML=parse(t),displayD(),displayU(),tablePagination()}))}document.querySelector("input[name=berat_pulang]").addEventListener("keyup",(function(){document.querySelector("input[name=berat_bersih]").value=this.value})),document.querySelector("input[name=refaksi]").addEventListener("keyup",(function(){const t=document.querySelector("input[name=berat_bersih]"),n=parseInt(document.querySelector("input[name=berat_pulang]").value)-parseInt(this.value);t.value=n.toString()})),displayU(),document.getElementById("filter").addEventListener("click",(function(){filter()}));const parse=t=>{let n="",a=1;return t.data.map((t=>{n+=htmldata(t,a++)})),n},htmldata=(t,n)=>`<tr>\n <td>${n}</td>\n <td>${formatTanggal(t.tanggal_keberangkatan)}</td>\n <td>${t.no_sp}</td>\n <td>${t.nama_petani}</td>\n <td>${t.no_induk}</td>\n <td>${t.wilayah}</td>\n <td>${formatRupiah(t.harga.toString(),"Rp ")}</td>\n <td>\n <button type="button" class="btn btn-primary text-bold detail" id="detail" data-target="#modal-lg-2" data-toggle="modal" data-id="${t.id_keberangkatan}"><i class="fas fa-info-circle"></i>&nbsp;Detail</button>\n <button type="button" class="btn btn-success text-bold update" data-target="#modal-lg" data-toggle="modal" data-id="${t.id_keberangkatan}"><i class="fas fa-pencil-alt"></i>&nbsp;Ubah</button>\n <a href="/pulang/${t.id_keberangkatan}" class="btn btn-danger text-bold"><i class="far fa-trash-alt"></i>&nbsp;Hapus</a>\n </td>\n</tr>`,tablePagination=()=>{$("#tb").dataTable({searching:!1,lengthChange:!1,language:{info:"Halaman ke _PAGE_ dari _PAGES_"}})};function displayD(){const t=document.getElementsByClassName("detail");for(let n=0;n<t.length;n++)t[n].addEventListener("click",(function(){const t=this.getAttribute("data-id");fetch(URL+"/detail?id="+t).then((t=>t.json())).then((t=>{document.getElementById("tabel_detail").innerHTML=htmldetail(t.data)}))}))}displayD();const htmldetail=t=>"SPT"==t.tipe?`<thead>\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <th>Tanggal Keberangkatan</th>\n <th>Tanggal Bongkar</th>\n <th>No Sp</th>\n <th>Nama Pemilik</th>\n <th>Tujuan</th>\n <th>No Truk</th>\n <th>Berat Pulang</th>\n <th>Berat Bersih</th>\n </tr>\n </thead>\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n </tr>\n <tbody id="detail1">\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <td>${formatTanggal(t.tanggal_keberangkatan)}</td>\n <td>${formatTanggal(t.tanggal_bongkar)}</td>\n <td>${t.no_sp}</td>\n <td>${t.nama_petani}</td>\n <td>${t.pabrik_tujuan}</td>\n <td>${t.no_truk}</td>\n <td>${t.berat_pulang}</td>\n <td>${t.netto_pulang}</td>\n </tr>\n </tbody>\n <thead>\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <th>Tanggal Kepulangan</th>\n <th>Tipe</th>\n <th>No Induk</th>\n <th>Nama Petani</th>\n <th>Wilayah</th>\n <th>Harga</th>\n <th>Refaksi</th>\n </tr>\n </thead>\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n </tr>\n <tbody id="detail2">\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <td>${formatTanggal(t.tanggal_pulang)}</td>\n <td>${t.tipe}</td>\n <td>${t.no_induk}</td>\n <td>${t.nama_sopir}</td>\n <td>${t.wilayah}</td>\n <td>${formatRupiah(t.harga.toString(),"Rp ")}</td>\n <td>${t.refaksi}</td>\n </tr></tbody>`:`<thead>\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <th>Tanggal Keberangkatan</th>\n <th>Tanggal Bongkar</th>\n <th>No Sp</th>\n <th>Nama Pemilik</th>\n <th>Tujuan</th>\n <th>No Truk</th>\n <th>Berat Timbang</th>\n <th>Netto</th>\n <th>Berat Pulang</th>\n <th>Berat Bersih</th>\n </tr>\n </thead>\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n </tr>\n <tbody id="detail1">\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <td>${formatTanggal(t.tanggal_keberangkatan)}</td>\n <td>${formatTanggal(t.tanggal_bongkar)}</td>\n <td>${t.no_sp}</td>\n <td>${t.nama_petani}</td>\n <td>${t.pabrik_tujuan}</td>\n <td>${t.no_truk}</td>\n <td>${t.berat_timbang}</td>\n <td>${t.netto}</td>\n <td>${t.berat_pulang}</td>\n <td>${t.netto_pulang}</td>\n </tr>\n </tbody>\n <thead>\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <th>Tanggal Kepulangan</th>\n <th>Tipe</th>\n <th>No Induk</th>\n <th>Nama Petani</th>\n <th>Wilayah</th>\n <th>Sangu</th>\n <th>Tara</th>\n <th>Harga</th>\n <th>Refaksi</th>\n </tr>\n </thead>\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n <td>:</td>\n </tr>\n <tbody id="detail2">\n <tr class="col-sm" style="display: flex; flex-direction: column;">\n <td>${formatTanggal(t.tanggal_pulang)}</td>\n <td>${t.tipe}</td>\n <td>${t.no_induk}</td>\n <td>${t.nama_sopir}</td>\n <td>${t.wilayah}</td>\n <td>${t.sangu}</td>\n <td>${t.tara_mbl}</td>\n <td>${formatRupiah(t.harga.toString(),"Rp ")}</td>\n <td>${t.refaksi}</td>\n </tr></tbody>`,formatTanggal=t=>{const n=t.split("-");return`${n[2]}/${["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","November","Desember"][parseInt(n[1])-1]}/${n[0]}`},formatRupiah=(t,n)=>{var a=t.replace(/[^,\d]/g,"").toString().split(","),e=a[0].length%3,d=a[0].substr(0,e),l=a[0].substr(e).match(/\d{3}/gi);return l&&(separator=e?".":"",d+=separator+l.join(".")),d=null!=a[1]?d+","+a[1]:d,null==n?d:d?"Rp. "+d:""};